{
  "hash": "41d2c9dc42cdee7cfc83838732b9ba2b",
  "result": {
    "markdown": "---\ntitle: \"Data Visualization\"\nauthor: \"Tommy Weber\"\n---\n\n\n# Covid case graph\n\n## Data Wrangling\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-1_42ffb1718234d99ffbdec0349ab6773a'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ncovid_data_tbl <- read_csv(\"https://covid.ourworldindata.org/data/owid-covid-data.csv\")\n\ncountry_vect <- c(\"Germany\", \"France\", \"United Kingdom\", \"Spain\", \"United States\")\n\n# Countries\ncountry_data_tbl <- covid_data_tbl %>% \n  select(location, date, total_cases) %>% \n  filter(location %in% country_vect & !is.na(total_cases))\n\n# Europe\neurope_data_tbl <- covid_data_tbl %>% \n  select(continent, date, total_cases) %>% \n  filter(continent == \"Europe\" & !is.na(total_cases)) %>% \n  group_by(date) %>% \n  summarise(total_cases = sum(total_cases)) %>% \n  ungroup() %>% \n  mutate(location = \"Europe\")\n\n# Combine country and Europe tables\nwrangled_data_tbl <- europe_data_tbl %>% \n  add_row(country_data_tbl)\n\n# Create the label data used to display the current \n# total for Europe and the USA\nlabel_data <- wrangled_data_tbl %>% \n  filter(date == max(date)) %>% \n  filter(location == \"Europe\" | location == \"United States\") %>% \n  mutate(total_cases_label = scales::number(total_cases, \n                                            big.mark = \".\", \n                                            decimal.mark = \",\"))\n```\n:::\n\n## Visualizing\n\n\n::: {.cell hash='04_data_visualization_cache/html/plot1_ae3be46498eb851932b24215f988a8d7'}\n\n```{.r .cell-code}\nwrangled_data_tbl %>% \n  ggplot(aes(date, total_cases, color = location)) +\n  geom_line(linewidth = 0.5, linetype = 1) +\n  geom_label(\n    aes(label = total_cases_label),\n    data = label_data,\n    hjust = \"inward\",\n    nudge_y = 20000000,\n    show.legend = F) +\n  \n  scale_x_date(\n    date_breaks = \"1 month\",\n    date_labels = \"%B '%y\") +\n  scale_y_continuous(labels = scales::dollar_format(scale = 1e-6,\n                                                    prefix = \"\",\n                                                    suffix = \"M\")) +\n  \n  labs(\n    title = \"Covid-19 confirmed cases worldwide\",\n    subtitle = \"As of 06.05.2023\",\n    color = \"Continent / Country\",\n    x = \"\",\n    y = \"Cumulative Cases\"\n  ) +\n  \n  theme_grey() +\n  theme(\n    plot.background = element_rect(fill = \"#552525\"),\n    text = element_text(color = \"white\"),\n    axis.text.x = element_text(color = \"white\", angle = 45, hjust = 1, size = 6),\n    axis.text.y = element_text(color = \"white\", size = 6),\n    legend.background = element_rect(fill = \"#332525\"),\n    legend.key = element_blank(),\n    legend.text = element_text(color = \"white\", size = 6),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/plot1-1.png){width=672}\n:::\n:::\n\n# Case-fatality map\n\n## Data Wrangling\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-2_b885552935e119e4ab042eaba1686bf7'}\n\n```{.r .cell-code}\ncurrent_covid_data <- covid_data_tbl %>%\n  \n  # Select the necessary data\n  filter(date == \"2023-04-01\") %>% \n  mutate(death_per_case = total_deaths / total_cases) %>% \n  select(location, death_per_case) %>%\n  \n  # Rename some locations so that they match with the map_data regions\n  mutate(location = case_when(\n\n    location == \"United Kingdom\" ~ \"UK\",\n    location == \"United States\" ~ \"USA\",\n    location == \"Democratic Republic of Congo\" ~ \"Democratic Republic of the Congo\",\n    TRUE ~ location\n\n  )) %>%\n  distinct()\n\n# Combine covid and world data\nmap_covid_data_tbl <- map_data(\"world\") %>% \n  left_join(current_covid_data, \n            by = join_by(\"region\" == \"location\"))\n```\n:::\n\n\n## Visualizing\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-3_6069b0744332017cc3617e943063515e'}\n\n```{.r .cell-code}\nmap_covid_data_tbl %>% \n  ggplot(aes(map_id = region)) +\n  \n  geom_map(aes(fill = death_per_case), map = map_covid_data_tbl) +\n  \n  expand_limits(x = map_covid_data_tbl$long, y = map_covid_data_tbl$lat) +\n  \n  scale_fill_gradient(low = \"#99FF99\", high = \"#005500\",\n                      labels = scales::dollar_format(scale = 1e2,\n                                                     prefix = \"\",\n                                                     suffix = \"%\")) +\n  \n  labs(\n    title = \"Covid-19 Case-fatality Rate\",\n    caption = \"Date: 04/01/2023\",\n    fill = \"Case-fatality Rate\"\n  ) +\n  \n  theme(\n    plot.background = element_rect(fill = \"#441111\"),\n    panel.background = element_blank(),\n    plot.title = element_text(color = \"white\", size = 20),\n    text = element_text(color = \"white\"),\n    axis.title = element_blank(),\n    axis.text = element_blank(),\n    legend.background = element_rect(fill = \"#552525\"),\n    legend.key = element_blank(),\n    legend.text = element_text(color = \"white\", size = 6),\n  )\n```\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}